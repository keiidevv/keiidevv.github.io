---
title: Toby | 1-2. 제어의 역전, IoC
author: serin
date: 2024-09-04 21:30:00 +0900
categories: [Backend, Spring]
image:
  path: /assets/img/Backend/Spring/20240904/main.png
  alt: main
---

> 해당 글은 [토비의 스프링 3.1 Vol.1 스프링의 이해와 원리] 책의 정리글입니다.

## 제어의 역전

제어의 역전이라는 것은 간단하게 말하면 프로그램의 제어 흐름 구조가 뒤바뀌는 것이라고 설명할 수 있다.  
Spring 에서는 직접 new 키워드를 통해 객체를 직접 생성하지 않고, **객체의 모든 생명 주기를 Spring Container가 책임**진다. 

즉, 객체 관리의 모든 책임을 위임함으로서  
1. 내부 로직 구현에 집중할 수 있고
2. 코드으이 양을 줄일 수 있고
3. 손쉽게 클래스를 테스트하고 유지보수 할 수 있다.

*이렇듯 개발자가 아닌 프레임워크가 객체를 제어하는 권한을 가져, 제어의 반전된 흐름을 가진 설계 원칙을 IoC라고 한다.*

그렇다면 스프링에서는 어떤 식으로 쓰이는지 예제로서 확인해 보자.

### 용어
### 빈 (bean)
> 스프링이 IoC 방식으로 관리하는 오브젝트
{: .prompt-info}

주의할 점은 모든 오브젝트가 다 빈은 아니다. 그 중에서 스프링이 직접 그 생성과 제어를 담당하는 오브젝트만을 빈이라고 부른다.

### 빈 팩토리 (bean factory)
> 스프링의 IoC를 담당하는 핵심 컨테이너
{: .prompt-info}

빈 등록, 생성, 조회, 리턴 등 모든 관리 기능을 담당한다.  
보통은 이를 확장한 애플리케이션 컨텍스트를 이용한다.

### 애플리케이션 컨텍스트 (application context)
> 빈 팩토리를 확장한 IoC 컨테이너이다.
{: .prompt-info}

빈을 관리하는 기본적인 기능은 빈 팩토리와 동일하다.  
여기에 스프링이 제공하는 각종 부가 서비스를 추가로 제공하므로 전반적인 기능을 모두 포함해서 이야기할 때 언급된다.

### 설정정보 (configuration metadata)
> 애플리케이션 컨텍스트 또는 빈 팩토리가 IoC를 적용하기 위해 사용하는 메타정보이다.
{: .prompt-info}

- 컨테이너에 어떤 기능을 세팅하거나 조정하는 경우에 사용
- IoC 컨테이너에 의해 관리되는 애플리케이션 오브젝트를 생성하고 고정할 때 사용
- = 애플리케이션 형상 정보
  - = 청사진(blueprint)


### 스프링 예시
스프링에서는 애플리케이션 전반에 걸쳐 모든 구성요소와 제어 작업을 담당하는 IoC 엔진을 **애플리케이션 컨텍스트**라고 한다.

애플리케이션 컨텍스트는 별도의 정보를 참고하여
- 빈(오브젝트) 생성
- 관계설정 등
제어 작업을 총괄한다.

![ioc](/assets/img/Backend/Spring/20240904/toby1-2-1.png)

1. DaoFactory 클래스를 설정 정보로 등록해 둔다.
   1. `@Bean` 이 붙은 메소드의 이름을 가져와 빈 목록을 만들어 둔다.
2. 클라이언트에서 `getBean()` 메소드를 호출하면
   1. 빈 목록에서 요청한 이름이 있는지 찾고
   2. 있다면 빈을 생성하는 메소드를 호출하여
   3. 오브젝트를 생성한다.
3. 생성된 오브젝트를 클라이언트에게 돌려준다.

이렇게 애플리케이션 컨텍스트를 사용하였을 때의 장점은

> 클라이언트는 구체적인 팩토리 클래스를 알 필요가 없다.
{: prompt-tip}

즉, 사용자가 직접 오브젝트를 가져올 필요 없이 일관된 방식으로 원하는 오브젝트를 가져올 수 있게 된다.

> 애플리케이션 컨텍스트는 종합 IoC 서비스를 제공해 준다.
{: prompt-tip}

- 오브젝트가 만들어지는 방식, 시점과 전략을 다르게 가져갈 수 있다.
- 추가 활용이 가능하다.
  - 자동 생성
  - 오브젝트에 대한 후처리
  - 정보의 조합
  - 설정 방식의 다변화
  - 인터셉팅
- 외부 시스템과의 연동을 컨테이너 차원에서 제공해줄 수 있다.

> 애플리케이션 컨텍스트는 빈을 검색하는 다양한 방법을 제공한다.
{: prompt-tip}


